[supervisord]
nodaemon=true
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
user=root

[program:xvfb]
command=/usr/bin/Xvfb :0 -screen 0 1920x1080x24 -ac +extension GLX +render -noreset -dpi 96
autostart=true
autorestart=true
stdout_logfile=/var/log/supervisor/xvfb.log
stderr_logfile=/var/log/supervisor/xvfb.log
priority=10

[program:x11vnc]
command=/usr/bin/x11vnc -display :0 -nopw -xkb -ncache 10 -ncache_cr -forever -shared -rfbport 5900 -geometry 1920x1080 -noxdamage
autostart=true
autorestart=true
stdout_logfile=/var/log/supervisor/x11vnc.log
stderr_logfile=/var/log/supervisor/x11vnc.log
priority=30

[program:api]
command=uvicorn api:app --host 0.0.0.0 --port 8000
directory=/srv/src
environment=DISPLAY=:0
autostart=true
autorestart=true
stdout_logfile=/var/log/supervisor/api.log
stderr_logfile=/var/log/supervisor/api.log
priority=40

[program:mcp]
command=python3 mcp_server.py
directory=/srv/src
environment=DISPLAY=:0
autostart=true
autorestart=true
stdout_logfile=/var/log/supervisor/mcp.log
stderr_logfile=/var/log/supervisor/mcp.log
priority=50

[program:novnc]
command=websockify --web=/opt/noVNC 6080 localhost:5900
autostart=true
autorestart=true
stdout_logfile=/var/log/supervisor/novnc.log
stderr_logfile=/var/log/supervisor/novnc.log
priority=60

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autostart=true
autorestart=true
stdout_logfile=/var/log/supervisor/nginx.log
stderr_logfile=/var/log/supervisor/nginx.log
priority=70
